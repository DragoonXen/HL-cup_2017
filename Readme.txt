Что бы ни случилось - никогда не используйте части этого кода в продакшн. Его автор не умеет нормальтно писать на C/C++ и не несёт ответственности за ваши косяки.
